import type { iTransaction } from "~/types/transactions";

export const useTransactions = () => {
  const supabaseClient = useSupabaseClient();

  interface iFilter {
    sort?: boolean;
  }

  const getTransactions = async (filter: iFilter = { sort: false }) => {
    const { data, error } = await supabaseClient
      .from("transactions")
      .select(
        `id,
          created_at,
          amount,
          notes,
          categories!inner(name, type)`
      )
      .order("created_at", { ascending: filter.sort });

    if (error) {
      console.error("Error fetching transactions:", error);
      return [];
    }
    return data as iTransaction[];
  };

  return {
    getTransactions,
  };
};
